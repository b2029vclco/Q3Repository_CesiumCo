<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Q3 2nd Graded Exercise">
    <meta name="keywords" content="HTML Forms">
    <meta name="author" content="AL Mendoza">
    <title>Sample Form</title>
    <!-- updated external css link to show how to share it between repository -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../styles.css" />
    <link rel="icon" href="../../assets/pshslogo.png" sizes="32x32" type="image/png">
    <script src="script.js" defer></script>

   <style>
        body{
          padding: 25px;
          font-family: arial;
          width: 80%;
          margin-left: 10%;
          }

        .title {
            color: #5C6AC4;
        }

        fieldset:nth-child(2) {
             margin-top: 20px;
        }

        legend {
            background: black;
            color: yellow;
            padding: 5px;
        }
        label {
             margin: 5%;
        }
        .blur {
          border: 2px solid red;
          background-color: rgb(253, 109, 109);
        }
        .focus {
          border: 2px solid rgb(0, 38, 255);
          background-color: rgb(128, 162, 255);
        }        
        .buttons {
          text-align: center;
        }
    </style>
    
  </head>
  <body>
    <section>
      <h1 class="title">Sign-up Page</h1>

      <a href="viewSignUps.html">List of Students</a>

      <form id="dForm" method="post" onsubmit = "confirmSubmission(event)" onreset = "confirmReset(event)">
        <fieldset>
          <legend>Your Credentials</legend><br/>
          <label> StudentID: 
            <input type="number" name="number" id="number" required onblur = "bblur(this)" onfocus = "ffocus(this)"/>
          </label><br/><br/>

          <label> Full Name: 
            <input type="text" name="uname" id="uname" required onblur = "bblur(this)" onfocus = "ffocus(this)"/>
          </label><br/><br/>

          <label> Date Of Birth :
            <input type="date" name="dob" id="dob" required onblur = "bblur(this)" onfocus = "ffocus(this)"/>
          </label><br/><br/>   

          <label> Email Address :
            <input type="email" name="email" id="email" required onblur = "bblur(this)" onfocus = "ffocus(this)"/>
          </label><br/><br/>

          <label> Mobile Phone: 
            <input type="text" name="phone" id="phone" required onblur = "bblur(this)" onfocus = "ffocus(this)"/>
          </label><br/><br/>

          <label> Grade Level: 
            <select name="Grade" id="Grade" required onblur = "bblur(this)" onfocus = "ffocus(this)" >
            <option value=""></option>
            <option value="Grade7">Grade 7</option>
            <option value="Grade8">Grade 8</option>
            <option value="Grade9">Grade 9</option>
            <option value="Grade10">Grade 10</option>
            <option value="Grade11">Grade 11</option> 
            <option value="Grade12">Grade 12</option>
          </label><br/><br/>


          <label> Intern/Extern :
            <input type="radio" name="yes" id="intern" value="Intern" required onblur = "bblur(this)" onfocus = "ffocus(this)"/> Intern
            <input type="radio" name="yes" id="extern" value="Extern" required onblur = "bblur(this)" onfocus = "ffocus(this)"/> Extern
          </label><br/><br/>

          <label> Preferred Organization/Club: 
            <select name="Preferred" id="Preferred" required onblur = "bblur(this)" onfocus = "ffocus(this)">
            <option value=""></option>
            <option value="Tomorrow">Tomorrow</option>
            <option value="Bahaghari">Bahaghari</option>
            <option value="Alianti">Alianti</option>
            <option value="Volant">Volant</option>
            <option value="MUN">MUN</option> 
            <option value="Labuyo">Labuyo</option>
            <option value="The Science Scholar">The Science Scholar</option>
            <option value="Lagablab">Lagablab</option>
            <option value="Math Club">Math Club</option>
            <option value="Invictus">Invictus</option>
            </select>             
          </label><br/><br/>

          <label> Why do you want to join : 
            <textarea name="reason" id="reason" required onblur = "bblur(this)" onfocus = "ffocus(this)"></textarea>
          </label><br/><br/>
          
          
        </fieldset>
        <fieldset>
          <legend>Action Buttons</legend>
          <button type="submit"> Accept </button>
          <input type="reset" value=" Clear " />
        </fieldset> 
      </form>
    </section>
    <script>

     const KEY = 'students';

     function loadStudents() {
      const raw = localStorage.getItem(KEY);

      if (raw){  //check if raw is not null or undefined
        return JSON.parse(raw);
      }
      else{
        return []; //if undefined, empty array
      }
     }      


    function saveToLocal() {
      //get from the form
      const studentID = document.getElementById('number').value.trim();
      const name = document.getElementById('uname').value.trim();
      const birth = document.getElementById('dob').value.trim();
      const email = document.getElementById('email').value.trim();
      const mobile = document.getElementById('phone').value.trim();
      const gradelevel = document.getElementById('Grade').value.trim();
      const club = document.getElementById('Preferred').value.trim();
      const internOrExtern = (document.getElementById('intern').checked?"Intern":"Extern");

      //put in object
      const obj = {
        studentID: studentID,
        name: name,
        birth: birth,
        email: email,
        mobile: mobile,
        gradelevel: gradelevel,
        club: club,
        internOrExtern: internOrExtern
      }

      const students = loadStudents();
      //add to array and save
      students.push(obj);   
      localStorage.setItem(KEY, JSON.stringify(students));


     }

    function bblur(elem) {
      if (elem.value.trim() === "") {
        elem.classList.remove("focus");
        elem.classList.add("blur");
      } else {
        elem.classList.remove("blur");
      }
    }

    function ffocus(elem) {
      if (elem.value.trim() === "") {
        elem.classList.remove("blur");        
        elem.classList.add("focus");
      } else {
        elem.classList.remove("focus");
      }
    }

    function confirmSubmission(event){
      const userConfirmed = confirm("Are you sure you want to submit this form?");
      if (userConfirmed)
      {
        event.preventDefault();
        saveToLocal();
        alert("Form submission saved.");

        //reset the fields for new input
        document.getElementById('number').value = '';
        document.getElementById('uname').value = '';
        document.getElementById('dob').value = '';
        document.getElementById('email').value = '';
        document.getElementById('phone').value = '';
        document.getElementById('Grade').value = '';
        document.getElementById('Preferred').value = '';
        document.getElementById('intern').checked = false;
        document.getElementById('extern').checked = false;
        document.getElementById('reason').value = '';

      }
    
      if (!userConfirmed) {
          event.preventDefault();
          alert("Form submission cancelled.");
      }
    } 



    function confirmReset(event) {
      const userConfirmed = confirm("Are you sure you want to reset all the information? ");
      
      if (!userConfirmed) {
          event.preventDefault();
          alert("Form submission cancelled.");
      }
    } 


 
    </script>

  </body>
</html>